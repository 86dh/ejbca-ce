<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<ui:remove>
	<!--
    /*************************************************************************
     *                                                                       *
     *  EJBCA: The OpenSource Certificate Authority                          *
     *                                                                       *
     *  This software is free software; you can redistribute it and/or       *
     *  modify it under the terms of the GNU Lesser General Public           *
     *  License as published by the Free Software Foundation; either         *
     *  version 2.1 of the License, or any later version.                    *
     *                                                                       *
     *  See terms of license at gnu.org.                                     *
     *                                                                       *
     *************************************************************************/

      -->
</ui:remove>


<ui:composition template="/WEB-INF/include/popup.xhtml">

	<ui:param name="resourceBean" value="#{editEndEntityMBean}" />
	<ui:define name="content">

		<h2>
			<h:outputText value="#{web.text.EDIT_ENDENTITY_HEADING}" />
		</h2>
		
		<h:form id="editendentity" enctype="multipart/form-data">

			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row1"
				columnClasses="editColumnSystem1,editColumn2">
				<h:outputLabel 
					value="#{web.text.ENDENTITYPROFILE}"
					style="font-weight:bold; font-size:1.2em;" />
					
			<h:panelGroup id="endEntityProfile">
					<h:selectOneMenu value="#{resourceBean.selectedEeProfileId}"
						disabled="#{!resourceBean.allowedToEditEndEntity}">
						<f:selectItems value="#{resourceBean.availableEndEntityProfiles}" />
						<f:ajax render="editendentity"
							listener="#{resourceBean.actionChangeEndEntityProfile}" />
					</h:selectOneMenu>
					<br />
					<h:outputLabel styleClass="help"
						value="#{web.text.WARNINGCHANGINGPROFILE}" />
			</h:panelGroup>					

		    <!-- ********** Status ******************** -->
			<h:panelGroup>
				<h:outputLabel id="eeStatus"
					value="#{web.text.STATUS}" />
			</h:panelGroup>

			<h:panelGroup id="selectChangeEeStatus">
					<h:selectOneMenu value="#{resourceBean.eeStatus}"
						disabled="#{!resourceBean.allowedToEditEndEntity}">
						<f:selectItems value="#{resourceBean.availableEeStatus}" />
					</h:selectOneMenu>
			</h:panelGroup>
			</h:panelGrid>

		    <!-- ********** Status ******************** -->
			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row1"
				columnClasses="editColumnSystem1,editColumn2">
				<h:outputLabel 
					value="#{web.text.USERNAME}"
					style="font-weight:bold; font-size:1.2em;" />
				<h:inputText size="40" maxlength="255" value="#{resourceBean.userName}" rendered="#{resourceBean.userNameHasRegex}"
				 			title="Must match format specified in profile. / Technical detail - the regex is #{resourceBean.userNameRegex}"
							required='true'
							styleClass='mandatory'>
				
					<f:validateRegex pattern="#{resourceBean.userNameRegex}" />
				</h:inputText> 

				<h:inputText size="40" maxlength="255" value="#{resourceBean.userName}" rendered="#{!resourceBean.userNameHasRegex}"
							required='true'
							styleClass='mandatory'>
				</h:inputText> 

			<h:panelGroup rendered="#{!resourceBean.useAutoGeneratedPasswd}">
				<h:outputLabel id="eePasswordLabel" 
					value="#{web.text.PASSWORDORENROLLMENTCODE}" />
			
			</h:panelGroup>


				<h:panelGroup rendered="#{!resourceBean.useAutoGeneratedPasswd}">

					<h:inputSecret autocomplete="new-password" id="passwordInput"
						size="20" maxlength="255" value="#{resourceBean.eePassword}"
						required="#{resourceBean.passwordRequired}"
						rendered="#{resourceBean.passwordModifiable}" 
						styleClass="#{resourceBean.passwordRequired ? 'mandatory' : ''}" />
					<h:selectOneMenu id="selectPassword"
						rendered="#{!resourceBean.passwordModifiable}"
						value="#{resourceBean.selectedPassword}" 
						styleClass="#{resourceBean.passwordRequired ? 'mandatory' : ''}"
						required="#{resourceBean.passwordRequired}">
						<f:selectItems value="#{resourceBean.selectPasswordList}" />
					</h:selectOneMenu>

				</h:panelGroup>

				
				
				<h:panelGroup rendered="#{resourceBean.useAutoGeneratedPasswd}">
				
				
					<h:outputLabel id="eePasswordLabelAutoGenerated" 
						value="#{web.text.PASSWORD}" />
						
						
						<h:selectBooleanCheckbox
							id="checkBoxRegenPassword"
							value="#{resourceBean.regeneratePassword}"
							disabled="#{subjectDnFieldAndData.required}"
							required="#{resourceBean.passwordRequired}" />
						<h:outputLabel for="checkBoxRegenPassword" value="#{web.text.REGENERATENEWPASSWORD}" />
				
				</h:panelGroup>
				
				
			<h:panelGroup rendered="#{!resourceBean.useAutoGeneratedPasswd}">
				<h:outputLabel id="eePasswordConfirmLabel" 
					value="#{web.text.CONFIRMPASSWORD}" />
			
			</h:panelGroup>


			<h:panelGroup rendered="#{!resourceBean.useAutoGeneratedPasswd}">

					<h:inputSecret autocomplete="new-password" id="passwordConfirmInput"
						size="20" maxlength="255" value="#{resourceBean.eeConfirmPassword}"
						rendered="#{resourceBean.passwordModifiable}" />
					<h:selectOneMenu id="selectConfirmPassword"
						rendered="#{!resourceBean.passwordModifiable}"
						value="#{resourceBean.selectedPassword}">
						<f:selectItems value="#{resourceBean.selectPasswordList}" />
					</h:selectOneMenu>

			</h:panelGroup>
				
			<h:panelGroup>
				<h:outputLabel id="eeMaxLoginLabel" 
					value="#{web.text.MAXFAILEDLOGINATTEMPTS}" />
			
			</h:panelGroup>	
				
			<h:panelGroup>
					<h:panelGrid columns="3">
						<h:selectOneRadio id="maxLoginAttemptsSpecifiedRadio"
							value="#{resourceBean.maxLoginAttemptsStatus}"
							readonly="#{!resourceBean.allowedToEditEndEntity or !resourceBean.maxFailedLoginAttemptsModifiable}">
							<f:selectItem itemLabel="#{web.text.UNLIMITED}"
								itemValue="unlimited" />
							<f:selectItem itemLabel="#{web.text.SPECIFIED}"
								itemValue="specified" />
							<f:ajax
								render=":editendentity:maxLoginAttemptsSpecifiedText maxLoginAttemptsUnlimitedRadio" />
						</h:selectOneRadio>
						<h:inputText id="maxLoginAttemptsSpecifiedText"
							value="#{resourceBean.maxLoginAttempts}" size="5"
							title="#{web.text.FORMAT_INTEGER}"
							disabled="#{resourceBean.maxLoginAttemptsStatus eq 'unlimited'}"
							readonly="#{!resourceBean.allowedToEditEndEntity or !resourceBean.maxFailedLoginAttemptsModifiable}" />
					</h:panelGrid>
				</h:panelGroup>	
				
				
			<h:panelGroup>
				<h:outputLabel id="eeRemainingLoginAttemptsLabel" 
					value="#{web.text.REMAININGLOGINATTEMPTS}" />
			</h:panelGroup>	
			
			<h:panelGroup>
			
			
				<h:inputText id="eeRemainingLoginAttemptsText"
							value="#{resourceBean.maxLoginAttempts}" size="5" maxlength="255"
							title="#{web.text.FORMAT_INTEGER}"
							disabled="#{resourceBean.maxLoginAttemptsStatus eq 'unlimited'}"
							readonly="#{!resourceBean.allowedToEditEndEntity or !resourceBean.maxFailedLoginAttemptsModifiable}" />

				<h:selectBooleanCheckbox
							id="checkBoxResetMaxLoginAttempts"
							value="#{resourceBean.resetMaxLoginAttempts}"
							disabled="true"/>
						<h:outputLabel for="checkBoxResetMaxLoginAttempts" value="#{web.text.RESETLOGINATTEMPTS}" />
							
			</h:panelGroup>
				

			<h:panelGroup rendered="#{resourceBean.useBatchGenerationPassword}">
				<h:outputLabel id="useInBatchLabel" 
					value="#{web.text.USEINBATCH}" />
			</h:panelGroup>	
				
			<h:panelGroup rendered="#{resourceBean.useBatchGenerationPassword}">

				<h:selectBooleanCheckbox
							id="checkBoxUseBatchGenerationPassword"
							value="#{resourceBean.useClearTextPasswordStorage}"
							disabled="#{resourceBean.requiredClearTextPasswordStorage}" />
						<h:outputLabel for="checkBoxUseBatchGenerationPassword" value="#{web.text.USE}" />
							
			</h:panelGroup>				
				

			</h:panelGrid>
		
		
		</h:form>
	</ui:define>
</ui:composition>
</html>		